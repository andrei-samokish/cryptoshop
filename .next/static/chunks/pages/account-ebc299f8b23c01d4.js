(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[966],{682:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/account",function(){return n(5224)}])},6239:function(e,t,n){"use strict";n.d(t,{Z:function(){return j}});var a=n(5893),s=n(967),r=n(849),i=n(5553),c=n(7294),o=n(2256),l=n(7257),d=n(7002),u=n(7632);function h(e){let{item:t}=e,[n,s]=(0,c.useState)(0);async function r(e,t){try{(await (0,d.Z)()).buy(e.id,t,{gasLimit:3e6,value:e.price*t}),console.log(e.price*t)}catch(n){console.error(n)}}return(0,a.jsx)("div",{className:"w-1/3",children:(0,a.jsxs)(o.Z,{raised:!0,centered:!0,children:[(0,a.jsx)(l.Z,{src:"data:image/svg+xml;base64,".concat(t.img),wrapped:!0,ui:!1}),(0,a.jsxs)(o.Z.Content,{children:[(0,a.jsx)(o.Z.Header,{children:t.name}),(0,a.jsx)(o.Z.Meta,{children:t.desc}),(0,a.jsx)(o.Z.Description,{children:(0,a.jsxs)("div",{className:"flex flex-row items-center",children:[i.dF(t.price)+"Ξ",(0,a.jsx)("button",{className:" text-stone-600 ml-[15px] mr-[5px] bg-stone-300 p-[5px] h-[25px] w-[25px] rounded hover:bg-[#666666] hover:text-cyan-50 text-center",onClick:function(){n>0&&s(e=>e-1)},children:"-"}),n,(0,a.jsx)("button",{className:" text-stone-600 ml-[5px] bg-stone-300 p-[5px] h-[25px] w-[25px] rounded hover:bg-[#666666] hover:text-cyan-50 text-center",onClick:function(){s(e=>e+1)},children:"+"}),(0,a.jsx)("button",{className:" text-stone-600 bg-stone-300 mx-[10px] px-[0.7em] h-[30px] w-[70px] rounded hover:bg-[#666666] hover:text-cyan-50 ",onClick:async()=>await r(t,n),children:"Buy"})]})})]})]},(0,u.Z)())})}var x=n(8005),m=n(1873),p=n(416);function f(e){let{item:t,amount:n}=e,[r,h]=(0,c.useState)(0),[f,j]=(0,c.useState)(!1);async function g(e){try{await (await (0,d.Z)()).fillStock(e,r)}catch(t){console.error(t)}}async function w(e){try{await (await (0,d.Z)()).withdrawFromSale(e)}catch(t){console.error(t)}}return(0,c.useEffect)(()=>{(async()=>{let e=await (await (0,d.Z)()).signer.getAddress();t.seller===e&&j(!0)})()},[]),(0,a.jsxs)(o.Z,{children:[(0,a.jsx)(l.Z,{src:"data:image/svg+xml;base64,".concat(t.img),wrapped:!0,ui:!1}),(0,a.jsxs)(o.Z.Content,{children:[(0,a.jsx)(o.Z.Header,{children:t.name}),(0,a.jsx)(o.Z.Meta,{children:i.dF(t.price)+"Ξ"}),(0,a.jsxs)(o.Z.Description,{children:["You have ",n," of those!"]})]}),f&&(0,a.jsx)(o.Z.Content,{extra:!0,children:(0,a.jsxs)(x.Z,{columns:2,children:[(0,a.jsx)(x.Z.Column,{stretched:!0,children:(0,a.jsx)(m.Z,{trigger:(0,a.jsx)(s.Z,{content:"Withdraw from sale",basic:!0}),content:(0,a.jsx)(s.Z,{color:"red",content:"Sure?",onClick:()=>w(t.id)}),on:"click",position:"top right"})}),(0,a.jsx)(x.Z.Column,{stretched:!0,children:(0,a.jsx)(m.Z,{trigger:(0,a.jsx)(s.Z,{content:"Fill stock",basic:!0}),content:(0,a.jsxs)(p.Z,{placeholder:"amount",type:"text",action:!0,onChange:e=>h(parseInt(e.target.value)),children:[(0,a.jsx)("input",{}),(0,a.jsx)(s.Z,{onClick:()=>g(t.id),children:"Fill"})]}),on:"click",position:"top right"})})]})})]},(0,u.Z)())}function j(e){let{items:t,amounts:n,onMoreClick:i,isLoading:c}=e;return(0,a.jsx)(a.Fragment,{children:(0,a.jsxs)("div",{className:"flex flex-row w-full h-auto flex-wrap justify-start",children:[t.map((e,t)=>n?(0,a.jsx)(f,{item:e,amount:n[t]}):(0,a.jsx)(h,{item:e},t)),t.length?(0,a.jsx)("div",{className:"w-1/3 flex justify-center items-center",children:(0,a.jsx)(s.Z,{size:"big",onClick:async()=>await i(),loading:c,children:"Load More"})}):(0,a.jsx)(r.Z,{size:"big",active:!0,children:"Loading"})]})})}},9430:function(e,t,n){"use strict";n.d(t,{Z:function(){return u}});var a=n(5893),s=n(7294),r=n(5712),i=n(1664),c=n.n(i),o=n(1163),l=n(4702);function d(){let[e,t]=(0,s.useState)(""),n=(0,o.useRouter)();return(0,a.jsxs)(l.Z,{children:[(0,a.jsx)(c(),{href:"/main",children:(0,a.jsx)(l.Z.Item,{children:(0,a.jsx)("div",{className:"font-black text-lg hover:underline",children:"ζ"})})}),(0,a.jsx)(c(),{href:"/account",children:(0,a.jsx)(l.Z.Item,{children:(0,a.jsx)("div",{className:"font-black text-lg hover:underline",children:"Personal account"})})}),(0,a.jsx)(l.Z.Item,{position:"right",children:(0,a.jsx)("div",{className:"ui input",children:(0,a.jsx)("input",{type:"text",placeholder:"Search...",value:e,onChange:e=>t(e.target.value),onKeyDown(t){localStorage.setItem("req",e),"Enter"==t.key&&n.push("/search")}})})})]})}function u(e){let{children:t}=e;return(0,a.jsxs)(r.Z,{children:[(0,a.jsx)(d,{}),t]})}},9362:function(e,t,n){"use strict";var a,s;n.d(t,{L:function(){return a}}),(s=a||(a={})).general="general",s.personal="personal",s.searched="searched"},6250:function(e,t,n){"use strict";n.d(t,{Z:function(){return r}});var a=n(7002),s=n(2556);async function r(e,t,n){let r=[],i=[],c=await (0,a.Z)();switch(t){case"general":for(let o=e;o<e+8;o++)try{let l=await s.Z.items(o);if(!(await s.Z.balanceOf(l[2],o)).toNumber())continue;let d=await s.Z.names(o),u={id:o,name:d,desc:l[0],img:l[1],seller:l[2],price:l[3].toNumber()};r.push(u)}catch(h){break}break;case"personal":for(let x=e;x<e+8;x++)try{let m=await c.ownedItems(await c.signer.getAddress(),x,0),p=await c.ownedItems(await c.signer.getAddress(),x,1),f=await s.Z.items(m),j=await s.Z.names(m);i.push(p.toNumber());let g={id:m.toNumber(),name:j,desc:f[0],img:f[1],seller:f[2],price:f[3].toNumber()};r.push(g)}catch(w){console.error(w);break}break;case"searched":for(let b=e;b<e+8;b++)try{let Z=await s.Z.names(b);if(!Z.toLowerCase().includes(n))continue;let y=await s.Z.items(b);if(!(await s.Z.balanceOf(y[2],b)).toNumber())continue;let v={id:b,name:Z,desc:y[0],img:y[1],seller:y[2],price:y[3].toNumber()};r.push(v)}catch(N){break}}return[r,i]}},5224:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return Z}});var a=n(5893),s=n(1886),r=n(1664),i=n.n(r),c=n(7294),o=n(967),l=n(7002),d=n(6239),u=n(9430),h=n(9362),x=n(3321),m=n(4623),p=n(3623),f=n(594);function j(e){let{placeholder:t,on_change:n}=e;return(0,a.jsx)("input",{type:"text",onChange:e=>n(e),className:"border-[2px] w-[350px] border-black mx-[25px] my-[15px] text-center font-mono block text-black",placeholder:t})}var g=function(){let e;let[t,n]=(0,c.useState)(""),[s,r]=(0,c.useState)(""),[i,o]=(0,c.useState)(0),[d,u]=(0,c.useState)(0),[h,x]=(0,c.useState)(""),[m,p]=(0,c.useState)(!1),[g,w]=(0,c.useState)(null),[b,Z]=(0,c.useState)("");async function y(){p(!0);try{if(!g)return;let t=new FormData;t.append("myImage",g);let{data:n}=await f.Z.post("/api/image",t);e=n.SVGFormula}catch(s){var a;console.log(null===(a=s.response)||void 0===a?void 0:a.data)}p(!1)}async function v(n){n.preventDefault(),t&&s&&g&&i&&d?(await y(),(await (0,l.Z)()).submitCommodity(t,s,btoa(e),i,d)):x("it is nessesary to fill all the fields")}return(0,a.jsx)("div",{className:"ui-form",children:(0,a.jsxs)("form",{onSubmit:v,children:[(0,a.jsxs)("div",{className:"flex",children:[(0,a.jsx)("input",{className:"w-[0.1px] h-[0.1px] overflow-hidden absolute z-[-1]",type:"file",id:"file",onChange(e){let{target:t}=e;if(t.files){let n=t.files[0],a=URL.createObjectURL(n);Z(a),w(n)}}}),(0,a.jsx)("label",{htmlFor:"file",className:"text-center w-[150px] h-[50px] font-mono font-medium mx-[25px] my-[15px] bg-slate-400 cursor-pointer border-black border-[2px] block hover:bg-slate-600 hover:text-white hover:border-white",children:(0,a.jsx)("h1",{className:"pt-[10px] font-mono font-medium text-base",children:"Choose an image"})}),(0,a.jsx)("img",{src:b})]}),(0,a.jsxs)("div",{className:"metadata-input",children:[(0,a.jsx)(j,{placeholder:"enter the name of the product",on_change:e=>n(e.target.value)}),(0,a.jsx)(j,{placeholder:"enter the description",on_change:e=>r(e.target.value)}),(0,a.jsx)(j,{placeholder:"enter the price",on_change:e=>o(Number(e.target.value))}),(0,a.jsx)(j,{placeholder:"enter stock",on_change:e=>u(Number(e.target.value))})]}),""===h?"":(0,a.jsx)("h1",{className:"m-[auto]",children:h}),(0,a.jsx)("button",{onClick:v,disabled:m,style:{opacity:m?".5":"1"},className:"block border-[2px] w-[100px] h-[50px] mx-[25px] my-[15px]",children:m?"Uploading..":"Upload"})]})})};function w(e){let{open:t,setOpen:n}=e;return(0,a.jsx)(x.Z,{onClose:()=>n(!1),open:t,children:(0,a.jsxs)(m.Z,{style:{left:"40%",position:"fixed",top:"50%",zIndex:1e3},children:[(0,a.jsx)(p.Z,{children:"Submit your commodity here!"}),(0,a.jsx)(g,{})]})})}var b=n(6250),Z=function(){let[e,t]=(0,c.useState)(!1),[n,r]=(0,c.useState)(),[x,m]=(0,c.useState)([]),[p,f]=(0,c.useState)([]),[j,g]=(0,c.useState)(!0),[Z,y]=(0,c.useState)(!0),[v,N]=(0,c.useState)(0);async function k(){y(!0);let e=(await (0,b.Z)(v,h.L.general))[0];m([...x,...e]),N(e=>e+8),y(!1)}async function S(){try{await (await (0,l.Z)()).becomeSeller({gasLimit:15e4})}catch(e){console.error(e)}}return(0,c.useEffect)(()=>{(async()=>{let e=await (0,l.Z)();r(await e.hasRole(s.wn(["string"],["SELLER_ROLE"]),await e.signer.getAddress()));let[t,n]=await (0,b.Z)(0,h.L.personal);m(t),f(n),y(!1),N(e=>e+8),n.length?g(!0):g(!1)})()},[]),(0,a.jsx)("div",{className:"bg-gradient-to-b from-indigo-500 to-gray-300 h-screen",children:(0,a.jsxs)(u.Z,{children:[void 0===n?null:!0===n?(0,a.jsx)(o.Z,{onClick:()=>t(!0),children:"Submit item for sale"}):(0,a.jsx)(o.Z,{onClick:async()=>await S(),loading:Z,children:"Become seller"}),(0,a.jsx)(w,{open:e,setOpen:t}),j?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("h1",{className:"text-white",children:"Your items:"}),(0,a.jsx)(d.Z,{items:x,amounts:p,onMoreClick:k,isLoading:Z})]}):(0,a.jsxs)("h1",{className:"text-white",children:["Seems like you dont have any items yet..."," ",(0,a.jsxs)(i(),{href:"/main",children:[" ",(0,a.jsx)("span",{className:"text-gray-300 hover:underline",children:"Buy one!"})," "]})]})]})})}}},function(e){e.O(0,[639,430,664,796,774,888,179],function(){return e(e.s=682)}),_N_E=e.O()}]);